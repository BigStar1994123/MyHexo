---
title: 20181018工作日誌
tags:
  - 工作
category:
  - 工作日誌
date: 2018-10-18 10:11:21
---
## 暫存 ##

```
  var list = new List<string>
  {
      s,s,s,s,s
  };

  foreach(var s in list)
  {
      eventBravoEntity.PossessedFragments.Add(s);
      await _equipmentService.GotchaOneNewEquipment
                        (playerDataEntity.PossessedEquipments.Id, s, 10);
  }

  await _bravoEventRepo.SaveBravoEventEntityAsync(eventBravoEntity);
```

```
{
    "indexingMode": "consistent",
    "automatic": true,
    "includedPaths": [
        {
            "path": "/*",
            "indexes": [
                {
                    "kind": "Range",
                    "dataType": "Number",
                    "precision": -1
                },
                {
                    "kind": "Range",
                    "dataType": "String",
                    "precision": -1
                }
            ]
        },
        {
            "path": "/Location/?",
            "indexes": [
                {
                    "kind": "Range",
                    "dataType": "Number",
                    "precision": -1
                },
                {
                    "kind": "Spatial",
                    "dataType": "Point"
                },
                {
                    "kind": "Range",
                    "dataType": "String",
                    "precision": -1
                }
            ]
        },
        {
            "path": "/\"$v\"/\"Location\"/\"$t\"/?",
            "indexes": [
                {
                    "kind": "Spatial",
                    "dataType": "Point"
                },
                {
                    "kind": "Spatial",
                    "dataType": "LineString"
                },
                {
                    "kind": "Spatial",
                    "dataType": "Polygon"
                },
                {
                    "kind": "Range",
                    "dataType": "Number",
                    "precision": -1
                },
                {
                    "kind": "Range",
                    "dataType": "String",
                    "precision": -1
                }
            ]
        },
        {
            "path": "/\"$v\"/\"Location\"/\"$v\"/?",
            "indexes": [
                {
                    "kind": "Spatial",
                    "dataType": "Point"
                },
                {
                    "kind": "Spatial",
                    "dataType": "LineString"
                },
                {
                    "kind": "Spatial",
                    "dataType": "Polygon"
                },
                {
                    "kind": "Range",
                    "dataType": "Number",
                    "precision": -1
                },
                {
                    "kind": "Range",
                    "dataType": "String",
                    "precision": -1
                }
            ]
        },
        {
            "path": "/\"$v\"/\"Location\"/\"$v\"/[]/?",
            "indexes": [
                {
                    "kind": "Spatial",
                    "dataType": "Point"
                },
                {
                    "kind": "Spatial",
                    "dataType": "LineString"
                },
                {
                    "kind": "Spatial",
                    "dataType": "Polygon"
                },
                {
                    "kind": "Range",
                    "dataType": "Number",
                    "precision": -1
                },
                {
                    "kind": "Range",
                    "dataType": "String",
                    "precision": -1
                }
            ]
        }
    ],
    "excludedPaths": [
        {
            "path": "/\"_etag\"/?"
        }
    ]
}
```

`insert for all data`  
db.BravoEventPoints.update({}, {$set : {"StartTime" : new ISODate("2012-01-10")} }, {upsert:false, multi:true})  
[StackOverflow : Mongodb Add new field to every document](https://stackoverflow.com/questions/7714216/add-new-field-to-every-document-in-a-mongodb-collection)  

`// update for all data`  
db.BravoEventPoints.update({}, {$set: {"EndTime" : null }}, {multi:true})  
db.BravoEventPoints.updateMany({},{$set: {"StartTime" : null }})  
[StackOverflow : Mongodb update all](https://stackoverflow.com/questions/9038547/mongodb-update-every-document-on-one-field)  


## List.Except 使用 Custom Class 做比對 ##

需要自定義 IEqualityComparer  

[[筆記]C# 用Except做差集資料比對 實作紀錄](https://dotblogs.com.tw/noncoder/2018/06/07/except)  

不小心查到 LINQ Except 的 Source Code  
[Github : dotnet/corefx](https://github.com/dotnet/corefx/blob/master/src/System.Linq/src/System/Linq/Except.cs)